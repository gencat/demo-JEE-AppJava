$(document).ready(function(){function t(){$.ajax({url:"api/logs/list"}).then(function(t){var e="";$.each(t,function(n){e+="DEBUG"==t[n].level?'<li data-rowid="'+t[n].name+'"><div class="logName">'+t[n].name+'</div><a href="#"><input type="button" value="DEBUG" style="background-color:green"/><input type="button" value="INFO" /><input type="button" value="ERROR" /><input type="button"value="FATAL" /><input type="button" value="WARN" /></a></li>':"INFO"==t[n].level?'<li data-rowid="'+t[n].name+'"><div class="logName">'+t[n].name+'</div><a href="#"><input type="button" value="DEBUG" /><input type="button" value="INFO" style="background-color:green"/><input type="button" value="ERROR" /><input type="button" value="FATAL" /><input type="button" value="WARN" /></a></li>':"ERROR"==t[n].level?'<li data-rowid="'+t[n].name+'"><div class="logName">'+t[n].name+'</div><a href="#"><input type="button" value="DEBUG" /><input type="button" value="INFO" /><input type="button" value="ERROR" style="background-color:green"/><input type="button" value="FATAL" /><input type="button" value="WARN" /></a></li>':"FATAL"==t[n].level?'<li data-rowid="'+t[n].name+'"><div class="logName">'+t[n].name+'</div><a href="#"><input type="button" value="DEBUG" /><input type="button" value="INFO" /><input type="button" value="ERROR" /><input type="button" value="FATAL" style="background-color:green"/><input type="button" value="WARN" /></a></li>':"WARN"==t[n].level?'<li data-rowid="'+t[n].name+'"><div class="logName">'+t[n].name+'</div><a href="#"><input type="button" value="DEBUG" /><input type="button" value="INFO" /><input type="button" value="ERROR" /><input type="button" value="FATAL" /><input type="button" value="WARN" style="background-color:green"/></a></li>':'<li data-rowid="'+t[n].name+'"><div class="logName">'+t[n].name+'</div><a href="#"><input type="button" value="DEBUG" /><input type="button" value="INFO" /><input type="button" value="ERROR" /><input type="button" value="FATAL" /><input type="button" value="WARN" /></a></li>'}),$("#thelist").empty().append(e)})}function e(){null!=a&&$.ajax({type:"PUT",url:"api/logs/keepwatch",data:a,contentType:"application/json; charset=utf-8",success:function(t){},error:function(t){}})}var n,a=null;jQuery(".tabs .tab-links a").on("click",function(t){var e=jQuery(this).attr("href");jQuery(".tabs "+e).show().siblings().hide(),jQuery(this).parent("li").addClass("active").siblings().removeClass("active"),t.preventDefault(),$("#selectAppender").find("option").remove(),(e="#tab2")&&$.ajax({url:"api/logs/appenders"}).then(function(t){$.each(t,function(e){$("#selectAppender").append($("<option>",{value:e,text:t[e].fileName}))})})}),t(),$("#thelist").on("click","li input",function(e){var n=$(this).parents("li").data("rowid"),a=$(this).val(),o={};o.name=n,o.level=a,$.ajax({type:"PUT",url:"api/logs/change",data:JSON.stringify(o),dataType:"json",contentType:"application/json; charset=utf-8",success:function(e){t()},error:function(t){alert("Ha fallat el canvi de logs")}})}),$("#connectar").click(function(){var t=$("#selectAppender option:selected").val();$.ajax({type:"PUT",url:"api/logs/startwatch",data:t,contentType:"application/json; charset=utf-8",success:function(e){var o=window.location.href,l=o.lastIndexOf("/"),i=o.substring(0,l+1);n=new SockJS(i+"api/watch"),stompClient=Stomp.over(n),stompClient.connect({},function(n){$("#logContent").empty(),$("#desconnectar").prop("disabled",!1),$("#connectar").prop("disabled",!0),$("#selectAppender").prop("disabled",!0),a=t,$("#connectionStatusIcon").removeClass(),$("#connectionStatusIcon").addClass("fa fa-lg fa-check-circle"),stompClient.subscribe(e,function(t){addLogMessage(t.body)})})},error:function(t){}})}),$("#desconnectar").click(function(){null!=a&&$.ajax({type:"PUT",url:"api/logs/stopwatch",data:a,contentType:"application/json; charset=utf-8",success:function(t){n.close(),$("#connectionStatusIcon").removeClass(),$("#connectionStatusIcon").addClass("fa fa-lg fa-exclamation-triangle"),a=null,$("#desconnectar").prop("disabled",!0),$("#connectar").prop("disabled",!1),$("#selectAppender").prop("disabled",!1)},error:function(t){}})}),$("#downloadLog").click(function(t){var e=$("#selectAppender option:selected").val(),n=document.createElement("a");n.setAttribute("href","api/logs/downloadLog/"+e),window.location.href=n.href}),$("#clearButton").click(function(t){$("#logContent").empty()}),$("#connectionStatusIcon").addClass("fa fa-lg fa-exclamation-triangle"),$("#desconnectar").prop("disabled",!0);setInterval(e,18e5)});